context("Transforms")


assign("attr.no", 1, envir=environment(genId))
# -----------------------------------------------------
# test-Transforms-1 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-2 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-3 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-4 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-5 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-6 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-7 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-8 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-9 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-10 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-11 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-12 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-13 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-14 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-15 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-16 Ommited!!!

# -----------------------------------------------------



# -----------------------------------------------------
test_that("test-Transforms-17", {
WH=c(600, 200) # window rect
wh=c(80,30) # small rect
pt=c(c,0)
svgR( 
  wh=WH, 
  g(
      rect( xy=pt, wh=wh, stroke ='black', fill='blue', opacity=.3),
      circle(cxy=pt, r=wh[2], stroke="black", fill="red", opacity=.3),
      transform="translate(200,100) rotate(-30) scale(.5,3) skewX(80)"
  )
 )->res
expected_res<-'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events" width="600" height="200">
<g transform="translate(200,100) rotate(-30) scale(.5,3) skewX(80)">
<rect stroke="black" fill="blue" opacity="0.3" width="80" height="30" x=".Primitive(&quot;c&quot;)" y="0"/>
<circle r="30" stroke="black" fill="red" opacity="0.3" cx=".Primitive(&quot;c&quot;)" cy="0"/>
</g>
</svg>'
    res <- as.character(res)
    rlines <- str_trim(strsplit(res, "\n")[[1]])
    elines <- str_trim(strsplit(expected_res, "\n")[[1]])
    expect_equal(length(rlines), length(elines))
    for (i in length(rlines)) {
        expect_identical(rlines[i], elines[i])
    }
})
# -----------------------------------------------------



# -----------------------------------------------------
# test-Transforms-18 Ommited!!!

# -----------------------------------------------------



